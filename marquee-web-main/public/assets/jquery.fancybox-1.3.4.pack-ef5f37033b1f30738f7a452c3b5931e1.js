/*
 * FancyBox - jQuery Plugin
 * Simple and fancy lightbox alternative
 *
 * Examples and documentation at: http://fancybox.net
 * 
 * Copyright (c) 2008 - 2010 Janis Skarnelis
 * That said, it is hardly a one-person project. Many people have submitted bugs, code, and offered their advice freely. Their support is greatly appreciated.
 * 
 * Version: 1.3.4 (11/11/2010)
 * Requires: jQuery v1.3+
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
!function(t){var e,i,s,n,r,a,o,h,l,c,d,u,f,p=0,_={},g=[],m=0,y={},v=[],b=null,w=new Image,x=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,k=/[^\.]\.(swf)\s*$/i,C=1,j=0,I="",O=!1,z=t.extend(t("<div/>")[0],{prop:0}),T=t.browser.msie&&t.browser.version<7&&!window.XMLHttpRequest,S=function(){i.hide(),w.onerror=w.onload=null,b&&b.abort(),e.empty()},E=function(){!1===_.onError(g,p,_)?(i.hide(),O=!1):(_.titleShow=!1,_.width="auto",_.height="auto",e.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),N())},A=function(){var s,n,r,o,h,l,c=g[p];if(S(),_=t.extend({},t.fn.fancybox.defaults,"undefined"==typeof t(c).data("fancybox")?_:t(c).data("fancybox")),l=_.onStart(g,p,_),l===!1)O=!1;else if("object"==typeof l&&(_=t.extend(_,l)),r=_.title||(c.nodeName?t(c).attr("title"):c.title)||"",c.nodeName&&!_.orig&&(_.orig=t(c).children("img:first").length?t(c).children("img:first"):t(c)),""===r&&_.orig&&_.titleFromAlt&&(r=_.orig.attr("alt")),s=_.href||(c.nodeName?t(c).attr("href"):c.href)||null,(/^(?:javascript)/i.test(s)||"#"==s)&&(s=null),_.type?(n=_.type,s||(s=_.content)):_.content?n="html":s&&(n=s.match(x)?"image":s.match(k)?"swf":t(c).hasClass("iframe")?"iframe":0===s.indexOf("#")?"inline":"ajax"),n)switch("inline"==n&&(c=s.substr(s.indexOf("#")),n=t(c).length>0?"inline":"ajax"),_.type=n,_.href=s,_.title=r,_.autoDimensions&&("html"==_.type||"inline"==_.type||"ajax"==_.type?(_.width="auto",_.height="auto"):_.autoDimensions=!1),_.modal&&(_.overlayShow=!0,_.hideOnOverlayClick=!1,_.hideOnContentClick=!1,_.enableEscapeButton=!1,_.showCloseButton=!1),_.padding=parseInt(_.padding,10),_.margin=parseInt(_.margin,10),e.css("padding",_.padding+_.margin),t(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){t(this).replaceWith(a.children())}),n){case"html":e.html(_.content),N();break;case"inline":if(t(c).parent().is("#fancybox-content")===!0){O=!1;break}t('<div class="fancybox-inline-tmp" />').hide().insertBefore(t(c)).bind("fancybox-cleanup",function(){t(this).replaceWith(a.children())}).bind("fancybox-cancel",function(){t(this).replaceWith(e.children())}),t(c).appendTo(e),N();break;case"image":O=!1,t.fancybox.showActivity(),w=new Image,w.onerror=function(){E()},w.onload=function(){O=!0,w.onerror=w.onload=null,_.width=w.width,_.height=w.height,t("<img />").attr({id:"fancybox-img",src:w.src,alt:_.title}).appendTo(e),q()},w.src=s;break;case"swf":_.scrolling="no",o='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+_.width+'" height="'+_.height+'"><param name="movie" value="'+s+'"></param>',h="",t.each(_.swf,function(t,e){o+='<param name="'+t+'" value="'+e+'"></param>',h+=" "+t+'="'+e+'"'}),o+='<embed src="'+s+'" type="application/x-shockwave-flash" width="'+_.width+'" height="'+_.height+'"'+h+"></embed></object>",e.html(o),N();break;case"ajax":O=!1,t.fancybox.showActivity(),_.ajax.win=_.ajax.success,b=t.ajax(t.extend({},_.ajax,{url:s,data:_.ajax.data||{},error:function(t){t.status>0&&E()},success:function(t,n,r){if(200==("object"==typeof r?r:b).status){if("function"==typeof _.ajax.win){if(l=_.ajax.win(s,t,n,r),l===!1)return void i.hide();("string"==typeof l||"object"==typeof l)&&(t=l)}e.html(t),N()}}}));break;case"iframe":q()}else E()},N=function(){var i=_.width,s=_.height;i=i.toString().indexOf("%")>-1?parseInt((t(window).width()-2*_.margin)*parseFloat(i)/100,10)+"px":"auto"==i?"auto":i+"px",s=s.toString().indexOf("%")>-1?parseInt((t(window).height()-2*_.margin)*parseFloat(s)/100,10)+"px":"auto"==s?"auto":s+"px",e.wrapInner('<div style="width:'+i+";height:"+s+";overflow: "+("auto"==_.scrolling?"auto":"yes"==_.scrolling?"scroll":"hidden")+';position:relative;"></div>'),_.width=e.width(),_.height=e.height(),q()},q=function(){var d,b;if(i.hide(),n.is(":visible")&&!1===y.onCleanup(v,m,y))t.event.trigger("fancybox-cancel"),O=!1;else{if(O=!0,t(a.add(s)).unbind(),t(window).unbind("resize.fb scroll.fb"),t(document).unbind("keydown.fb"),n.is(":visible")&&"outside"!==y.titlePosition&&n.css("height",n.height()),v=g,m=p,y=_,y.overlayShow?(s.css({"background-color":y.overlayColor,opacity:y.overlayOpacity,cursor:y.hideOnOverlayClick?"pointer":"auto",height:t(document).height()}),s.is(":visible")||(T&&t("select:not(#fancybox-tmp select)").filter(function(){return"hidden"!==this.style.visibility}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"}),s.show())):s.hide(),f=R(),I=y.title||"",j=0,h.empty().removeAttr("style").removeClass(),y.titleShow!==!1&&(d=t.isFunction(y.titleFormat)?y.titleFormat(I,v,m,y):I&&I.length?"float"==y.titlePosition?'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+I+'</td><td id="fancybox-title-float-right"></td></tr></table>':'<div id="fancybox-title-'+y.titlePosition+'">'+I+"</div>":!1,I=d,I&&""!==I))switch(h.addClass("fancybox-title-"+y.titlePosition).html(I).appendTo("body").show(),y.titlePosition){case"inside":h.css({width:f.width-2*y.padding,marginLeft:y.padding,marginRight:y.padding}),j=h.outerHeight(!0),h.appendTo(r),f.height+=j;break;case"over":h.css({marginLeft:y.padding,width:f.width-2*y.padding,bottom:y.padding}).appendTo(r);break;case"float":h.css("left",-1*parseInt((h.width()-f.width-40)/2,10)).appendTo(n);break;default:h.css({width:f.width-2*y.padding,paddingLeft:y.padding,paddingRight:y.padding}).appendTo(n)}h.hide(),n.is(":visible")?(t(o.add(l).add(c)).hide(),d=n.position(),u={top:d.top,left:d.left,width:n.width(),height:n.height()},b=u.width==f.width&&u.height==f.height,a.fadeTo(y.changeFade,.3,function(){var i=function(){a.html(e.contents()).fadeTo(y.changeFade,1,P)};t.event.trigger("fancybox-change"),a.empty().removeAttr("filter").css({"border-width":y.padding,width:f.width-2*y.padding,height:_.autoDimensions?"auto":f.height-j-2*y.padding}),b?i():(z.prop=0,t(z).animate({prop:1},{duration:y.changeSpeed,easing:y.easingChange,step:F,complete:i}))})):(n.removeAttr("style"),a.css("border-width",y.padding),"elastic"==y.transitionIn?(u=B(),a.html(e.contents()),n.show(),y.opacity&&(f.opacity=0),z.prop=0,t(z).animate({prop:1},{duration:y.speedIn,easing:y.easingIn,step:F,complete:P})):("inside"==y.titlePosition&&j>0&&h.show(),a.css({width:f.width-2*y.padding,height:_.autoDimensions?"auto":f.height-j-2*y.padding}).html(e.contents()),n.css(f).fadeIn("none"==y.transitionIn?0:y.speedIn,P)))}},D=function(){(y.enableEscapeButton||y.enableKeyboardNav)&&t(document).bind("keydown.fb",function(e){27==e.keyCode&&y.enableEscapeButton?(e.preventDefault(),t.fancybox.close()):37!=e.keyCode&&39!=e.keyCode||!y.enableKeyboardNav||"INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName||"SELECT"===e.target.tagName||(e.preventDefault(),t.fancybox[37==e.keyCode?"prev":"next"]())}),y.showNavArrows?((y.cyclic&&v.length>1||0!==m)&&l.show(),(y.cyclic&&v.length>1||m!=v.length-1)&&c.show()):(l.hide(),c.hide())},P=function(){t.support.opacity||(a.get(0).style.removeAttribute("filter"),n.get(0).style.removeAttribute("filter")),_.autoDimensions&&a.css("height","auto"),n.css("height","auto"),I&&I.length&&h.show(),y.showCloseButton&&o.show(),D(),y.hideOnContentClick&&a.bind("click",t.fancybox.close),y.hideOnOverlayClick&&s.bind("click",t.fancybox.close),t(window).bind("resize.fb",t.fancybox.resize),y.centerOnScroll&&t(window).bind("scroll.fb",t.fancybox.center),"iframe"==y.type&&t('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" '+(t.browser.msie?'allowtransparency="true""':"")+' scrolling="'+_.scrolling+'" src="'+y.href+'"></iframe>').appendTo(a),n.show(),O=!1,t.fancybox.center(),y.onComplete(v,m,y);var e,i;v.length-1>m&&(e=v[m+1].href,"undefined"!=typeof e&&e.match(x)&&(i=new Image,i.src=e)),m>0&&(e=v[m-1].href,"undefined"!=typeof e&&e.match(x)&&(i=new Image,i.src=e))},F=function(t){var e={width:parseInt(u.width+(f.width-u.width)*t,10),height:parseInt(u.height+(f.height-u.height)*t,10),top:parseInt(u.top+(f.top-u.top)*t,10),left:parseInt(u.left+(f.left-u.left)*t,10)};"undefined"!=typeof f.opacity&&(e.opacity=.5>t?.5:t),n.css(e),a.css({width:e.width-2*y.padding,height:e.height-j*t-2*y.padding})},$=function(){return[t(window).width()-2*y.margin,t(window).height()-2*y.margin,t(document).scrollLeft()+y.margin,t(document).scrollTop()+y.margin]},R=function(){var t=$(),e={},i=y.autoScale,s=2*y.padding;return e.width=y.width.toString().indexOf("%")>-1?parseInt(t[0]*parseFloat(y.width)/100,10):y.width+s,e.height=y.height.toString().indexOf("%")>-1?parseInt(t[1]*parseFloat(y.height)/100,10):y.height+s,i&&(e.width>t[0]||e.height>t[1])&&("image"==_.type||"swf"==_.type?(i=y.width/y.height,e.width>t[0]&&(e.width=t[0],e.height=parseInt((e.width-s)/i+s,10)),e.height>t[1]&&(e.height=t[1],e.width=parseInt((e.height-s)*i+s,10))):(e.width=Math.min(e.width,t[0]),e.height=Math.min(e.height,t[1]))),e.top=parseInt(Math.max(t[3]-20,t[3]+.5*(t[1]-e.height-40)),10),e.left=parseInt(Math.max(t[2]-20,t[2]+.5*(t[0]-e.width-40)),10),e},B=function(){var e=_.orig?t(_.orig):!1,i={};return e&&e.length?(i=e.offset(),i.top+=parseInt(e.css("paddingTop"),10)||0,i.left+=parseInt(e.css("paddingLeft"),10)||0,i.top+=parseInt(e.css("border-top-width"),10)||0,i.left+=parseInt(e.css("border-left-width"),10)||0,i.width=e.width(),i.height=e.height(),i={width:i.width+2*y.padding,height:i.height+2*y.padding,top:i.top-y.padding-20,left:i.left-y.padding-20}):(e=$(),i={width:2*y.padding,height:2*y.padding,top:parseInt(e[3]+.5*e[1],10),left:parseInt(e[2]+.5*e[0],10)}),i},M=function(){i.is(":visible")?(t("div",i).css("top",-40*C+"px"),C=(C+1)%12):clearInterval(d)};t.fn.fancybox=function(e){return t(this).length?(t(this).data("fancybox",t.extend({},e,t.metadata?t(this).metadata():{})).unbind("click.fb").bind("click.fb",function(e){e.preventDefault(),O||(O=!0,t(this).blur(),g=[],p=0,e=t(this).attr("rel")||"",e&&""!=e&&"nofollow"!==e?(g=t("a[rel="+e+"], area[rel="+e+"]"),p=g.index(this)):g.push(this),A())}),this):this},t.fancybox=function(e,i){var s;if(!O){if(O=!0,s="undefined"!=typeof i?i:{},g=[],p=parseInt(s.index,10)||0,t.isArray(e)){for(var n=0,r=e.length;r>n;n++)"object"==typeof e[n]?t(e[n]).data("fancybox",t.extend({},s,e[n])):e[n]=t({}).data("fancybox",t.extend({content:e[n]},s));g=jQuery.merge(g,e)}else"object"==typeof e?t(e).data("fancybox",t.extend({},s,e)):e=t({}).data("fancybox",t.extend({content:e},s)),g.push(e);(p>g.length||0>p)&&(p=0),A()}},t.fancybox.showActivity=function(){clearInterval(d),i.show(),d=setInterval(M,66)},t.fancybox.hideActivity=function(){i.hide()},t.fancybox.next=function(){return t.fancybox.pos(m+1)},t.fancybox.prev=function(){return t.fancybox.pos(m-1)},t.fancybox.pos=function(t){O||(t=parseInt(t),g=v,t>-1&&t<v.length?(p=t,A()):y.cyclic&&v.length>1&&(p=t>=v.length?0:v.length-1,A()))},t.fancybox.cancel=function(){O||(O=!0,t.event.trigger("fancybox-cancel"),S(),_.onCancel(g,p,_),O=!1)},t.fancybox.close=function(){function e(){s.fadeOut("fast"),h.empty().hide(),n.hide(),t.event.trigger("fancybox-cleanup"),a.empty(),y.onClosed(v,m,y),v=_=[],m=p=0,y=_={},O=!1}if(!O&&!n.is(":hidden"))if(O=!0,y&&!1===y.onCleanup(v,m,y))O=!1;else if(S(),t(o.add(l).add(c)).hide(),t(a.add(s)).unbind(),t(window).unbind("resize.fb scroll.fb"),t(document).unbind("keydown.fb"),a.find("iframe").attr("src",T&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank"),"inside"!==y.titlePosition&&h.empty(),n.stop(),"elastic"==y.transitionOut){u=B();var i=n.position();f={top:i.top,left:i.left,width:n.width(),height:n.height()},y.opacity&&(f.opacity=1),h.empty().hide(),z.prop=1,t(z).animate({prop:0},{duration:y.speedOut,easing:y.easingOut,step:F,complete:e})}else n.fadeOut("none"==y.transitionOut?0:y.speedOut,e)},t.fancybox.resize=function(){s.is(":visible")&&s.css("height",t(document).height()),t.fancybox.center(!0)},t.fancybox.center=function(t){var e,i;O||(i=t===!0?1:0,e=$(),!i&&(n.width()>e[0]||n.height()>e[1])||n.stop().animate({top:parseInt(Math.max(e[3]-20,e[3]+.5*(e[1]-a.height()-40)-y.padding)),left:parseInt(Math.max(e[2]-20,e[2]+.5*(e[0]-a.width()-40)-y.padding))},"number"==typeof t?t:200))},t.fancybox.init=function(){t("#fancybox-wrap").length||(t("body").append(e=t('<div id="fancybox-tmp"></div>'),i=t('<div id="fancybox-loading"><div></div></div>'),s=t('<div id="fancybox-overlay"></div>'),n=t('<div id="fancybox-wrap"></div>')),r=t('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(n),r.append(a=t('<div id="fancybox-content"></div>'),o=t('<a id="fancybox-close"></a>'),h=t('<div id="fancybox-title"></div>'),l=t('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),c=t('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>')),o.click(t.fancybox.close),i.click(t.fancybox.cancel),l.click(function(e){e.preventDefault(),t.fancybox.prev()}),c.click(function(e){e.preventDefault(),t.fancybox.next()}),t.fn.mousewheel&&n.bind("mousewheel.fb",function(e,i){O?e.preventDefault():(0==t(e.target).get(0).clientHeight||t(e.target).get(0).scrollHeight===t(e.target).get(0).clientHeight)&&(e.preventDefault(),t.fancybox[i>0?"prev":"next"]())}),t.support.opacity||n.addClass("fancybox-ie"),T&&(i.addClass("fancybox-ie6"),n.addClass("fancybox-ie6"),t('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(r)))},t.fn.fancybox.defaults={padding:10,margin:40,opacity:!1,modal:!1,cyclic:!1,scrolling:"auto",width:560,height:340,autoScale:!0,autoDimensions:!0,centerOnScroll:!1,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:!0,hideOnContentClick:!1,overlayShow:!0,overlayOpacity:.7,overlayColor:"#777",titleShow:!0,titlePosition:"float",titleFormat:null,titleFromAlt:!1,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:!0,showNavArrows:!0,enableEscapeButton:!0,enableKeyboardNav:!0,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}},t(document).ready(function(){t.fancybox.init()})}(jQuery);